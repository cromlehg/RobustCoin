# Основы работы со смарт-контрактом

## Взаимодействие со смарт-контрактом
Взаимодействие со смарт-контрактом происходит посредством вызова функций контракта с указанием параметров.
Для взаимодействия необходимо знать адрес смарт-контракта.
На основе адреса нужно получить ABI-интерфейс.
По ABI интерфейсу можно вызвать целевую функцию.

## Получение ABI интерфейса
Для получения интерфейса вам необходимо:
* Открыть https://etherscan.io


* В правом верхнем углу в окне с надписью «search by address» ввести адрес целевого смарт-контракта и нажать «go»



* Нажать на вкладку «contract source»:
  <details><summary>Скриншот</summary>

  ![how-to-find-contract-source](images/how-to-find-contract-source.png)

  </details>


* Найти поле с надписью «Contract ABI» и нажать на кнопку «copy» справа от надписи
  <details><summary>Скриншот</summary>

  ![how-to-find-contract-source](images/how-to-find-contract-source.png)

  </details>


* Интерфейс ABI контракта теперь скопирован в буфер обмена.

## Вызов функции
* Откройте кошелек https://www.myetherwallet.com


* Выберите вкладку «контракты» и заполните поля «Адрес контракта» и «ABI/JSON интерфейс» (его мы получили в предыдущей части инструкции). Нажмите на кнопку «подключиться».
  <details><summary>Скриншот</summary>

  ![how-to-interact-with-contract](images/how-to-interact-with-contract.png)

  </details>


* После этого нам станет доступен список функций контракта. Выбирите целевую функцию и заполните параметры.
  <details><summary>Скриншот</summary>

  ![how-to-call-a-function](images/how-to-call-a-function.png)

  </details>


* После выбора функции и заполнения параметров получите доступ к кошельку-владельцу смарт-контракта удобным вам способом и нажмите на кнопку «записать».
  <details><summary>Скриншот</summary>

  ![how-to-gain-an-access-to-a-function](images/how-to-gain-an-access-to-a-function.png)

  </details>


* Далее нажмите на кнопку «Да, я уверен, выполнить транзакцию».
  <details><summary>Скриншот</summary>

  ![how-to-confirm-transaction](images/how-to-confirm-transaction.png)

  </details>

>Внимание! Перед тем как нажать «записать» внимательно проверьте введенные данные. Часто формат данных отличается от привычного пользователю вида.

* После этого внизу появится зеленая панель со ссылкой «Verify transaction». Нажмите на эту ссылку, чтобы открыть страницу с информацией о транзакции в Etherscan. Ждите окончания выполнения транзакции.

## Как воспользоваться функцией ручного выпуска токенов
В каждом из контрактов распродажи (Presale и Mainsale) доступны две функции для ручного выпуска токенов:

* mintTokensExternal(to, tokens) - данная функция предназначена для непосредственного выпуска токенов.  
  <details><summary>Скриншот</summary>

  ![mint-tokens](images/mint-tokens.jpg)

  </details>
Принимает два параметра:  
  * «to» - адрес кошелька инвестора, на чей счет выпускаются токены
  * «tokens» - количество токенов, которое нужно выпустить

>Внимание! Для того, чтобы выпустить 1 токен, мы должны указать «1 000 000 000 000 000 000» в поле «tokens» (18 нулей, без пробелов).

* mintTokensByETHExternal(to, invested) - данная функция предназначена для выпуска токенов с автоматическим расчетом количества, в зависимости от даты и времени выполнения транзакции и суммы эфира, указанной в поле «invested».
  <details><summary>Скриншот</summary>

  ![mint-tokens-by-eth](images/mint-tokens-by-eth.jpg)

  </details>
Принимает два параметра:  
  * «to» - адрес кошелька инвестора, на чей счет выпускаются токены
  * «invested» - количество эфира, на основании которого будет производиться автоматический расчет (начисляться бонус, в зависимости от даты и времени выполнения транзакции)

>Внимание! Сумма «invested» указывается не в ETH, а в Wei. Это в 18 раз меньше, чем ETH.  
Для того, чтобы выпустить токены на сумму в 1 ETH, мы должны в поле «invested» указать «1 000 000 000 000 000 000» (18 нулей, без пробелов).

Вызывать данные функции может только владелец смарт-контракта.

## Как посмотреть интерфейс смарт-контракта
* Открыть https://etherscan.io
* В правом верхнем углу в окне с надписью «search by address» ввести адрес целевого смарт-контракта и нажать «go»
* В открывшейся странице нажать на вкладку «Read smart contract»
  <details><summary>Скриншот</summary>

  ![how-to-read-contract](images/how-to-read-contract.png)

  </details>

## Памятка владельцу смарт-контрактов
Владелец смарт-контрактов должен после каждой распродажи вызвать функцию finish() у соответствующего смарт-контракта распродажи. А именно:
* По окончанию распродажи у контракта Presale вызвать finish()  
адрес контракта станет известен после его размещения в основной сети
* По окончанию распродажи у контракта ICO вызвать finish()  
адрес контракта станет известен после его размещения в основной сети
* Перед вызовом убедитесь, что адрес контракта соответствует текущей распродаже!
